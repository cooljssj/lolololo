<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ—Ñ–∏–ª—å</title>
    <link rel="stylesheet" href="css/ProfileStyles.css">
    <link rel="stylesheet" href="css/Header.css">
    <link rel="stylesheet" href="css/Footer.css">
    <link rel="stylesheet" href="css/buttonStyle.css">
    <link rel="stylesheet" href="css/modals.css">
    <link rel="icon" href="img/Github-Octicons-Id-badge-16.512.png" type="image/png">
</head>
<body>
<header class="header">
    <div class="logo-container">
        <a href="main.html"><img src="img/logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" id="logo" style="width: 50px; height: 50px;"></a>
        <a class="YouKnow" href="main.html"><span>YouKnow</span></a>
    </div>
    <nav>
        <ul class="nav-links">
            <li>
                <div class="dropdown">
                    <button class="dropbtn">–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏</button>
                    <div class="dropdown-content">
                        <a href="Library.html">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</a>
                        <a href="Forum.html">–û–±—Å—É–∂–¥–µ–Ω–∏—è</a>
                        <a href="Courses.html">–ö—É—Ä—Å—ã</a>
                        <a href="Video.html">–í–∏–¥–µ–æ—É—Ä–æ–∫–∏</a>
                    </div>
                </div>
            </li>
            <li class="search-container">
                <input type="text" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å–∞–π—Ç—É">
                <button class="search-btn">üîç</button>
            </li>
            <li class="hamburger-menu">
                <button class="hamburger-btn">‚ò∞</button>
                <div class="dropdown-content">
                    <a href="profile.html">–ü—Ä–æ—Ñ–∏–ª—å</a>
                    <a href="#" class="settings-btn">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</a>
                    <a href="#" class="contactUS-btn">–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</a>
                    <a href="Questions.html" class="contactUS-btn">FAQ</a>
                </div>
            </li>
            <li><a href="#" class="login-btn">–í—Ö–æ–¥</a></li>
        </ul>
    </nav>
</header>

<div class="container">
    <h3>–í–∞—à –ø—Ä–æ—Ñ–∏–ª—å</h3>
    <div id="profile" style="position: relative;">
        <label for="fileInput">
            <img src="img/DefaultPFP.png" alt="–§–æ—Ç–æ –ø—Ä–æ—Ñ–∏–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç" class="profile-pic" id="profileImage"> 
        </label>
        <div class="profile-info">
            <p><strong>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:</strong> <span id="profileUsername"></span></p>
            <p><strong>–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞:</strong> <span id="profileEmail"></span></p>
            <p><strong>–ë–∏–æ–≥—Ä–∞—Ñ–∏—è:</strong></p>
            <textarea id="bioInput" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —á—Ç–æ-—Ç–æ –æ —Å–µ–±–µ..." maxlength="3000"></textarea>
            <button class="save-bio-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            <p><strong>–ò–Ω—Ç–µ—Ä–µ—Å—ã:</strong></p>
            <textarea id="interestsInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–∏ –∏–Ω—Ç–µ—Ä–µ—Å—ã (–ø–æ –æ–¥–Ω–æ–º—É –Ω–∞ —Å—Ç—Ä–æ–∫—É)..." rows="2" maxlength="500"></textarea>
            <div>
                <button class="add-interest-btn">–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å</button>
                <button class="save-interests-btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã</button>
            </div>
        </div>
        <input type="file" id="fileInput" accept="image/*" onchange="loadImage(event)" style="display:none;">     
        <p style="position: absolute; top: 15px; right: 15px;">
            <strong>–°—Ç–∞—Ç—É—Å:</strong>
            <select id="statusSelector" style="margin-left: 5px;">
                <option value="online">–í —Å–µ—Ç–∏</option>
                <option value="busy">–ó–∞–Ω—è—Ç</option>
                <option value="away">–û—Ç–æ—à–µ–ª</option>
            </select>
        </p>
    </div>
</div>
<div id="login-modal" class="modal" style="color: black;">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <h2>–í—Ö–æ–¥</h2>
            <form>
                <label for="username">–õ–æ–≥–∏–Ω:</label>
                <input type="text" id="username" name="username" required><br />
                <label for="password">–ü–∞—Ä–æ–ª—å:</label>
                <input type="password" id="password" name="password" required><br /><br />
                <a class="registerbutton" href="RegistrationForm.html">–°–æ–∑–¥–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç</a><br /><br />
                <button type="submit" class="submit">–í–æ–π—Ç–∏</button>
            </form>
        </div>
    </div>
    <div id="login-modal2" class="modal" style="color: black;">
        <div class="modal-content">
            <span class="close-btn2">&times;</span>
            <h2>–û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å</h2>
            <form>
                <label for="name">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à–µ –∏–º—è:</label>
                <input type="text" id="name" name="name"><br /> 
                <label for="email">–í–≤–µ–¥–∏—Ç–µ –≤–∞—à email:</label>
                <input type="email" id="email" name="email" required><br /> 
                <label for="message">–û–ø–∏—à–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º—É:</label><br /> 
                <textarea id="message" name="message" required style="width: 100%; height: 100px; background-color: #fff;"></textarea><br />
                <button type="submit" class="submit">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </form>
        </div>
    </div>
    <div id="login-modal3" class="modal" style="color: black;">
        <div class="modal-content">
            <span class="close-btn3">&times;</span>
            <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <form>
                <label for="theme">–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É</label>
                <a href="#">
                    <label class="switch">
                        <input type="checkbox" id="dark-mode-toggle">
                        <span class="slider"></span>
                    </label>
                </a>
            </form>
        </div>  
    </div>


<footer>
    <div class="social-links">
        <a href="https:// telegram.org/" target="_blank">
            <img id="Telegram" src="img/telegram.png" alt="Telegram">
        </a>
        <a href="https://github.com/Cooljssj-ty" target="_blank">
            <img id="Github" src="img/github.png" alt="Github">
        </a>
    </div>
    <p>–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</p>
    <p>–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏</p>
    <li style="list-style: none;"><a href="AboutUS.html" class="AboutUS">–û –Ω–∞—Å</a></li>
</footer>

<script src="buttonscript.js"></script>
<script>
    let interests = [];

    function loadImage(event) {
        const image = document.getElementById('profileImage');
        image.src = URL.createObjectURL(event.target.files[0]);
    }

    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
        return null;
    }

 window.onload = function() {
    const userId = getCookie('userId');

    if (!userId) {
        alert('–í—ã –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω—ã! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É.');
        window.location.href = 'RegistrationForm.html'; // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        return;
    }

 fetch(`/api/user/${userId}`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const user = data.user;
                document.getElementById('profileUsername').textContent = user.usname; // –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                document.getElementById('profileEmail').textContent = user.email; // –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞
            } else {
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª—è');
        });

    document.querySelector('.add-interest-btn').addEventListener('click', function() {
        const interestsInput = document.getElementById('interestsInput');
        const newInterest = interestsInput.value.trim();

        if (newInterest) {
            interests.push(newInterest);
            interestsInput.value = ''; // –û—á–∏—Å—Ç–∏—Ç—å –ø–æ–ª–µ –≤–≤–æ–¥–∞
            alert(`–ò–Ω—Ç–µ—Ä–µ—Å "${newInterest}" –¥–æ–±–∞–≤–ª–µ–Ω!`);
        } else {
            alert('–í–≤–µ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º.');
        }
    });

    document.querySelector('.save-interests-btn').addEventListener('click', function() {
        const userId = getCookie('userId');

        fetch(`/api/user/${userId}/interests`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ interests: interests })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('–ò–Ω—Ç–µ—Ä–µ—Å—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            } else {
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã.');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤');
        });
    });
function removeInterest(interest) {
 const index = interests.indexOf(interest);
        if (index !== -1) {
            interests.splice(index, 1);
            document.getElementById('interestsInput').value = interests.join('\n');
            const interestList = document.getElementById('interestList');
            interestList.innerHTML = ''; 
            interests.forEach(interest => {
                const listItem = document.createElement('li');
                listItem.textContent = interest;
                const removeBtn = document.createElement('button');
                removeBtn.textContent = '-';
                removeBtn.addEventListener('click', () => {
                    removeInterest(interest);
                });
                listItem.appendChild(removeBtn);
                interestList.appendChild(listItem);
            });
        }
    }

    document.querySelector('.add-interest-btn').addEventListener('click', function() {
        const interestsInput = document.getElementById('interestsInput');
        const newInterest = interestsInput.value.trim();

        if (newInterest) {
            interests.push(newInterest);
            interestsInput.value = '';
            const interestList = document.getElementById('interestList');
            const listItem = document.createElement('li');
            listItem.textContent = newInterest;
            const removeBtn = document.createElement('button');
            removeBtn.textContent = '-';
            removeBtn.addEventListener('click', () => {
                removeInterest(newInterest);
            });
            listItem.appendChild(removeBtn);
            interestList.appendChild(listItem);
        } else {
            alert('–í–≤–µ–¥–∏—Ç–µ –∏–Ω—Ç–µ—Ä–µ—Å –ø–µ—Ä–µ–¥ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º.');
        }
    });

    document.querySelector('.save-interests-btn').addEventListener('click', function() {
        const userId = getCookie('userId');

        fetch(`/api/user/${userId}/interests`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({ interests: interests.filter(Boolean) })
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('–ò–Ω—Ç–µ—Ä–µ—Å—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
            } else {
                alert('–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å—ã.');
            }
        })
        .catch(error => {
            console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤:', error);
            alert('–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤');
        });
    });
</script>
</body>
</html>